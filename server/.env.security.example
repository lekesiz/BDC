# Security Configuration Template for BDC Application
# Copy this file to .env and configure according to your environment

# ===== IP WHITELISTING =====
# Enable IP whitelisting (true/false)
ENABLE_IP_WHITELIST=false

# Comma-separated list of allowed IPs or CIDR ranges
# Default: 0.0.0.0/0 (allow all)
IP_WHITELIST=0.0.0.0/0

# Admin-only IP whitelist (for /admin endpoints)
# Example: 192.168.1.0/24,10.0.0.0/8
ADMIN_IP_WHITELIST=

# ===== THREAT DETECTION =====
# Enable threat detection (true/false)
ENABLE_THREAT_DETECTION=true

# Threat detection sensitivity: low, medium, high
THREAT_DETECTION_SENSITIVITY=medium

# ===== RATE LIMITING =====
# Requests per minute limits
RATE_LIMIT_DEFAULT=100
RATE_LIMIT_LOGIN=5
RATE_LIMIT_REGISTER=3
RATE_LIMIT_API=60
RATE_LIMIT_STRICT=10

# ===== SESSION SECURITY =====
# Secure cookie flag (true/false)
SESSION_COOKIE_SECURE=true

# Session lifetime in seconds (3600 = 1 hour)
SESSION_LIFETIME=3600

# ===== PASSWORD POLICY =====
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_DIGITS=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_HISTORY_COUNT=5

# ===== ACCOUNT SECURITY =====
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION=900
REQUIRE_EMAIL_VERIFICATION=true

# ===== FILE UPLOAD SECURITY =====
# Maximum file size in bytes (10485760 = 10MB)
MAX_FILE_SIZE=10485760

# Scan uploaded files for malware (true/false)
SCAN_UPLOADS=true

# ===== AUDIT LOGGING =====
ENABLE_AUDIT_LOGGING=true
LOG_SECURITY_EVENTS=true
AUDIT_LOG_RETENTION_DAYS=90

# ===== MULTI-FACTOR AUTHENTICATION =====
ENABLE_MFA=false
MFA_ISSUER_NAME=BDC Platform

# ===== API SECURITY =====
# Custom header for API key authentication
API_KEY_HEADER=X-API-Key

# Require API key for certain endpoints (true/false)
REQUIRE_API_KEY=false

# ===== CORS CONFIGURATION =====
# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:5173,http://127.0.0.1:5173

# ===== ENCRYPTION KEYS =====
# Database encryption key (for PII data)
DB_ENCRYPTION_KEY=

# ===== MONITORING =====
# External monitoring services
SENTRY_DSN=

# ===== EXAMPLES FOR PRODUCTION =====
# Production IP Whitelist Example:
# IP_WHITELIST=203.0.113.0/24,198.51.100.0/24
# ADMIN_IP_WHITELIST=10.0.0.0/8,172.16.0.0/12

# Production Security Settings:
# ENABLE_IP_WHITELIST=true
# ENABLE_THREAT_DETECTION=true
# THREAT_DETECTION_SENSITIVITY=high
# SESSION_COOKIE_SECURE=true
# ENABLE_MFA=true
# REQUIRE_API_KEY=true