<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BDC Navigation Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-6">BDC Navigation Test</h1>
        
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4">Quick Navigation Links</h2>
            
            <div class="grid grid-cols-2 gap-4">
                <a href="/login" class="bg-blue-500 text-white p-4 rounded text-center hover:bg-blue-600">
                    Login Page
                </a>
                <a href="/dashboard" class="bg-green-500 text-white p-4 rounded text-center hover:bg-green-600">
                    Dashboard
                </a>
                <a href="/portal" class="bg-purple-500 text-white p-4 rounded text-center hover:bg-purple-600">
                    Student Portal
                </a>
                <a href="/users" class="bg-yellow-500 text-white p-4 rounded text-center hover:bg-yellow-600">
                    Users
                </a>
                <a href="/beneficiaries" class="bg-indigo-500 text-white p-4 rounded text-center hover:bg-indigo-600">
                    Beneficiaries
                </a>
                <a href="/evaluations" class="bg-pink-500 text-white p-4 rounded text-center hover:bg-pink-600">
                    Evaluations
                </a>
                <a href="/documents" class="bg-red-500 text-white p-4 rounded text-center hover:bg-red-600">
                    Documents
                </a>
                <a href="/settings" class="bg-gray-500 text-white p-4 rounded text-center hover:bg-gray-600">
                    Settings
                </a>
            </div>
            
            <div class="mt-8">
                <h3 class="text-lg font-semibold mb-2">Current User Info</h3>
                <div id="userInfo" class="bg-gray-100 p-4 rounded">
                    <p>Loading...</p>
                </div>
            </div>
            
            <div class="mt-4">
                <button onclick="checkAuth()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    Check Authentication
                </button>
                <button onclick="clearAuth()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 ml-2">
                    Clear Auth & Logout
                </button>
            </div>
        </div>
    </div>

    <script>
        async function checkAuth() {
            const token = localStorage.getItem('access_token');
            const userInfoDiv = document.getElementById('userInfo');
            
            if (!token) {
                userInfoDiv.innerHTML = '<p class="text-red-600">No authentication token found. Please login.</p>';
                return;
            }
            
            try {
                const response = await fetch('http://localhost:5001/api/users/me', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const user = await response.json();
                    userInfoDiv.innerHTML = `
                        <p><strong>Email:</strong> ${user.email}</p>
                        <p><strong>Role:</strong> ${user.role}</p>
                        <p><strong>Name:</strong> ${user.first_name} ${user.last_name}</p>
                        <p class="text-green-600 mt-2">âœ“ Authenticated</p>
                    `;
                } else {
                    userInfoDiv.innerHTML = `<p class="text-red-600">Authentication failed: ${response.status}</p>`;
                }
            } catch (error) {
                userInfoDiv.innerHTML = `<p class="text-red-600">Error: ${error.message}</p>`;
            }
        }
        
        function clearAuth() {
            localStorage.removeItem('access_token');
            localStorage.removeItem('refresh_token');
            document.getElementById('userInfo').innerHTML = '<p class="text-yellow-600">Authentication cleared. Redirecting to login...</p>';
            setTimeout(() => {
                window.location.href = '/login';
            }, 1500);
        }
        
        // Check auth on load
        window.onload = checkAuth;
    </script>
</body>
</html>