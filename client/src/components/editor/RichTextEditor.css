/* Rich Text Editor Styles */
.rich-text-editor {
  @apply border rounded-lg overflow-hidden bg-white;
  position: relative;
}

.rich-text-editor.dark {
  @apply bg-gray-900 border-gray-700;
}

.rich-text-editor.focused {
  @apply ring-2 ring-primary ring-offset-2;
}

/* Loading State */
.rich-text-editor-loading {
  @apply flex items-center justify-center p-8;
}

.rich-text-editor-loading .spinner {
  @apply animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full;
}

/* Editor Wrapper */
.rich-text-editor-wrapper {
  @apply relative;
}

/* Editor Content */
.rich-text-editor-content {
  @apply p-4 overflow-y-auto;
  outline: none;
}

.rich-text-editor-content.dark {
  @apply text-gray-100;
}

/* Placeholder */
.rich-text-editor-placeholder {
  @apply absolute top-4 left-4 text-gray-400 pointer-events-none;
}

/* Toolbar Styles */
.editor-toolbar {
  @apply border-b bg-gray-50 p-2 flex items-center justify-between flex-wrap gap-2;
}

.editor-toolbar.dark {
  @apply bg-gray-800 border-gray-700;
}

.toolbar-section {
  @apply flex items-center gap-1;
}

.toolbar-button {
  @apply p-1.5 rounded transition-colors;
}

.toolbar-button:hover:not(:disabled) {
  @apply bg-gray-100;
}

.toolbar-button.active {
  @apply bg-primary text-white;
}

.toolbar-button:disabled {
  @apply opacity-50 cursor-not-allowed;
}

.toolbar-separator {
  @apply w-px h-6 bg-gray-300 mx-1;
}

.editor-toolbar.dark .toolbar-separator {
  @apply bg-gray-600;
}

/* Link Dialog */
.link-dialog {
  @apply absolute top-full left-0 right-0 bg-white border shadow-lg p-3 flex items-center gap-2 z-50;
}

.link-input {
  @apply flex-1 px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-primary;
}

/* Typography */
.rich-text-editor-content h1 {
  @apply text-3xl font-bold mb-4 mt-6;
}

.rich-text-editor-content h2 {
  @apply text-2xl font-bold mb-3 mt-5;
}

.rich-text-editor-content h3 {
  @apply text-xl font-bold mb-3 mt-4;
}

.rich-text-editor-content h4 {
  @apply text-lg font-bold mb-2 mt-4;
}

.rich-text-editor-content h5 {
  @apply text-base font-bold mb-2 mt-3;
}

.rich-text-editor-content h6 {
  @apply text-sm font-bold mb-2 mt-3;
}

.rich-text-editor-content p {
  @apply mb-3;
}

.rich-text-editor-content ul {
  @apply list-disc pl-6 mb-3;
}

.rich-text-editor-content ol {
  @apply list-decimal pl-6 mb-3;
}

.rich-text-editor-content li {
  @apply mb-1;
}

/* Task List */
.rich-text-editor-content ul[data-type="taskList"] {
  @apply list-none pl-0;
}

.rich-text-editor-content li[data-type="taskItem"] {
  @apply flex items-start gap-2;
}

.rich-text-editor-content li[data-type="taskItem"] > label {
  @apply flex items-center gap-2;
}

.rich-text-editor-content li[data-type="taskItem"] > label > input[type="checkbox"] {
  @apply rounded border-gray-300;
}

/* Code Blocks */
.rich-text-editor-content pre {
  @apply bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto mb-3;
}

.rich-text-editor-content code {
  @apply bg-gray-100 text-red-600 px-1.5 py-0.5 rounded text-sm;
}

.rich-text-editor-content pre code {
  @apply bg-transparent text-inherit p-0;
}

/* Tables */
.rich-text-editor-content table {
  @apply border-collapse w-full mb-3;
}

.rich-text-editor-content th,
.rich-text-editor-content td {
  @apply border px-3 py-2;
}

.rich-text-editor-content th {
  @apply bg-gray-100 font-semibold;
}

.rich-text-editor-content.dark th {
  @apply bg-gray-800;
}

/* Links */
.rich-text-link {
  @apply text-blue-600 underline hover:text-blue-800;
}

.rich-text-editor-content.dark .rich-text-link {
  @apply text-blue-400 hover:text-blue-300;
}

/* Images */
.rich-text-image {
  @apply max-w-full h-auto rounded-lg my-3;
}

/* Custom Extensions */

/* Question Hint */
.question-hint {
  @apply bg-yellow-100 text-yellow-900 px-2 py-1 rounded-md relative;
  position: relative;
}

.question-hint::before {
  content: 'ðŸ’¡';
  @apply mr-1;
}

.rich-text-editor-content.dark .question-hint {
  @apply bg-yellow-900 text-yellow-100;
}

/* Correct Answer */
.correct-answer {
  @apply bg-green-100 text-green-900 px-2 py-1 rounded-md font-semibold;
}

.correct-answer::before {
  content: 'âœ“';
  @apply mr-1;
}

.rich-text-editor-content.dark .correct-answer {
  @apply bg-green-900 text-green-100;
}

/* Explanation Block */
.explanation-block-wrapper {
  @apply bg-blue-50 border-l-4 border-blue-500 rounded-r-lg my-3 overflow-hidden;
}

.explanation-block-header {
  @apply bg-blue-100 px-3 py-2 flex items-center gap-2 text-blue-900 font-semibold;
}

.explanation-block-content {
  @apply p-3;
}

.rich-text-editor-content.dark .explanation-block-wrapper {
  @apply bg-blue-900 bg-opacity-20;
}

.rich-text-editor-content.dark .explanation-block-header {
  @apply bg-blue-800 bg-opacity-30 text-blue-100;
}

/* Mathematics */
.math-node-wrapper {
  @apply inline-block cursor-pointer rounded transition-all;
}

.math-node-wrapper.block {
  @apply block text-center my-3;
}

.math-node-wrapper.selected {
  @apply ring-2 ring-primary ring-offset-2;
}

.math-node-wrapper.editing {
  @apply cursor-default;
}

.math-placeholder {
  @apply inline-flex items-center gap-1 text-gray-400 border border-dashed border-gray-300 px-2 py-1 rounded;
}

.math-edit-button {
  @apply absolute -top-2 -right-2 bg-primary text-white p-1 rounded-full shadow-md opacity-0 transition-opacity;
}

.math-node-wrapper:hover .math-edit-button {
  @apply opacity-100;
}

.math-editor {
  @apply bg-white border rounded-lg shadow-lg p-4 min-w-[400px];
}

.math-editor-header {
  @apply flex items-center gap-2 mb-3 font-semibold;
}

.math-input {
  @apply w-full p-3 border rounded-lg font-mono text-sm focus:outline-none focus:ring-2 focus:ring-primary;
}

.math-error-message {
  @apply text-red-600 text-sm mt-2;
}

.math-preview {
  @apply mt-3 p-3 bg-gray-50 rounded-lg;
}

.math-preview-label {
  @apply text-sm text-gray-600 mb-2;
}

.math-editor-actions {
  @apply flex gap-2 mt-3;
}

.math-button {
  @apply flex items-center gap-1 px-3 py-1.5 rounded font-medium transition-colors;
}

.math-button.save {
  @apply bg-primary text-white hover:bg-primary-dark;
}

.math-button.cancel {
  @apply bg-gray-200 text-gray-700 hover:bg-gray-300;
}

/* Preview Mode */
.rich-text-editor-preview-banner {
  @apply absolute top-0 right-0 bg-primary text-white px-3 py-1 rounded-bl-lg flex items-center gap-2 text-sm;
}

.preview-toggle-btn {
  @apply underline hover:no-underline;
}

/* Text Alignment */
.rich-text-editor-content [style*="text-align: left"] {
  @apply text-left;
}

.rich-text-editor-content [style*="text-align: center"] {
  @apply text-center;
}

.rich-text-editor-content [style*="text-align: right"] {
  @apply text-right;
}

.rich-text-editor-content [style*="text-align: justify"] {
  @apply text-justify;
}

/* Highlight */
.rich-text-editor-content mark {
  @apply bg-yellow-200 text-yellow-900 px-1 rounded;
}

.rich-text-editor-content.dark mark {
  @apply bg-yellow-800 text-yellow-100;
}

/* Mobile Responsive */
@media (max-width: 640px) {
  .editor-toolbar {
    @apply p-1;
  }

  .toolbar-button {
    @apply p-1;
  }

  .math-editor {
    @apply min-w-0 w-full;
  }

  .rich-text-editor-content {
    @apply p-3;
  }
}

/* Syntax Highlighting (with lowlight) */
.hljs-comment,
.hljs-quote {
  @apply text-gray-600 italic;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-addition {
  @apply text-purple-600 font-semibold;
}

.hljs-number,
.hljs-string,
.hljs-meta .hljs-string,
.hljs-literal,
.hljs-doctag,
.hljs-regexp {
  @apply text-green-600;
}

.hljs-title,
.hljs-section,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class {
  @apply text-blue-600 font-semibold;
}

.hljs-attribute,
.hljs-attr,
.hljs-variable,
.hljs-template-variable,
.hljs-class .hljs-title,
.hljs-type {
  @apply text-orange-600;
}

.hljs-symbol,
.hljs-bullet,
.hljs-subst,
.hljs-meta,
.hljs-link {
  @apply text-red-600;
}

.hljs-deletion {
  @apply text-red-600 line-through;
}

.hljs-formula {
  @apply bg-gray-100 px-1 rounded;
}

.hljs-emphasis {
  @apply italic;
}

.hljs-strong {
  @apply font-bold;
}